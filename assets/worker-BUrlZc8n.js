/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const S=Symbol("Comlink.proxy"),H=Symbol("Comlink.endpoint"),N=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.finalizer"),h=Symbol("Comlink.thrown"),C=e=>typeof e=="object"&&e!==null||typeof e=="function",I={canHandle:e=>C(e)&&e[S],serialize(e){const{port1:t,port2:r}=new MessageChannel;return R(e,t),[r,[r]]},deserialize(e){return e.start(),j(e)}},V={canHandle:e=>C(e)&&h in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},T=new Map([["proxy",I],["throw",V]]);function F(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function R(e,t=globalThis,r=["*"]){t.addEventListener("message",function o(n){if(!n||!n.data)return;if(!F(r,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:s,type:a,path:c}=Object.assign({path:[]},n.data),f=(n.data.argumentList||[]).map(g);let i;try{const l=c.slice(0,-1).reduce((u,m)=>u[m],e),y=c.reduce((u,m)=>u[m],e);switch(a){case"GET":i=y;break;case"SET":l[c.slice(-1)[0]]=g(n.data.value),i=!0;break;case"APPLY":i=y.apply(l,f);break;case"CONSTRUCT":{const u=new y(...f);i=O(u)}break;case"ENDPOINT":{const{port1:u,port2:m}=new MessageChannel;R(e,m),i=G(u,[u])}break;case"RELEASE":i=void 0;break;default:return}}catch(l){i={value:l,[h]:0}}Promise.resolve(i).catch(l=>({value:l,[h]:0})).then(l=>{const[y,u]=b(l);t.postMessage(Object.assign(Object.assign({},y),{id:s}),u),a==="RELEASE"&&(t.removeEventListener("message",o),A(t),E in e&&typeof e[E]=="function"&&e[E]())}).catch(l=>{const[y,u]=b({value:new TypeError("Unserializable return value"),[h]:0});t.postMessage(Object.assign(Object.assign({},y),{id:s}),u)})}),t.start&&t.start()}function W(e){return e.constructor.name==="MessagePort"}function A(e){W(e)&&e.close()}function j(e,t){return z(e,[],t)}function p(e){if(e)throw new Error("Proxy has been released and is not useable")}function M(e){return d(e,{type:"RELEASE"}).then(()=>{A(e)})}const _=new WeakMap,w="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(_.get(e)||0)-1;_.set(e,t),t===0&&M(e)});function D(e,t){const r=(_.get(t)||0)+1;_.set(t,r),w&&w.register(e,t,e)}function U(e){w&&w.unregister(e)}function z(e,t=[],r=function(){}){let o=!1;const n=new Proxy(r,{get(s,a){if(p(o),a===N)return()=>{U(n),M(e),o=!0};if(a==="then"){if(t.length===0)return{then:()=>n};const c=d(e,{type:"GET",path:t.map(f=>f.toString())}).then(g);return c.then.bind(c)}return z(e,[...t,a])},set(s,a,c){p(o);const[f,i]=b(c);return d(e,{type:"SET",path:[...t,a].map(l=>l.toString()),value:f},i).then(g)},apply(s,a,c){p(o);const f=t[t.length-1];if(f===H)return d(e,{type:"ENDPOINT"}).then(g);if(f==="bind")return z(e,t.slice(0,-1));const[i,l]=k(c);return d(e,{type:"APPLY",path:t.map(y=>y.toString()),argumentList:i},l).then(g)},construct(s,a){p(o);const[c,f]=k(a);return d(e,{type:"CONSTRUCT",path:t.map(i=>i.toString()),argumentList:c},f).then(g)}});return D(n,e),n}function q(e){return Array.prototype.concat.apply([],e)}function k(e){const t=e.map(b);return[t.map(r=>r[0]),q(t.map(r=>r[1]))]}const L=new WeakMap;function G(e,t){return L.set(e,t),e}function O(e){return Object.assign(e,{[S]:!0})}function b(e){for(const[t,r]of T)if(r.canHandle(e)){const[o,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:o},n]}return[{type:"RAW",value:e},L.get(e)||[]]}function g(e){switch(e.type){case"HANDLER":return T.get(e.name).deserialize(e.value);case"RAW":return e.value}}function d(e,t,r){return new Promise(o=>{const n=Y();e.addEventListener("message",function s(a){!a.data||!a.data.id||a.data.id!==n||(e.removeEventListener("message",s),o(a.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:n},t),r)})}function Y(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let B=[0,1,2,3,4,5,6,7,8];const X=e=>({flop_analyzer:e.flop_analyzer.new(),results:null,reset(){this.flop_analyzer.reset()},setBoardCards(t){this.flop_analyzer.set_board_cards(t)},setPlayerCards(t,r){this.flop_analyzer.set_player_cards(t,r)},setPlayerRange(t,r){this.flop_analyzer.set_player_range(t,r)},setPlayerState(t,r){this.flop_analyzer.set_player_state(t,r)},clearPlayerCards(t){this.flop_analyzer.clear_player_cards(t)},initResults(){this.results=this.flop_analyzer.build_results(),console.log("initResults")},simulateFlop(t){if(!this.results){console.error("results not initialized");return}this.results=this.flop_analyzer.simulate_flop(t,this.results)},getResults(){console.log("getResults");const t=this.results;if(!t)return console.error("results falsy"),[];const r=t.get_num_players(),o=[];for(let n=0;n<r;++n){let s=x(t,n);o.push(s)}return o.push(x(t,void 0)),o}});function x(e,t){const r=[],o=[];for(let s=0;s<3;s++)r.push({equity:e.get_equity(t,s),rank_family_count:B.map(a=>({perc:e.get_perc_family(t,s,a),better:e.get_perc_family_or_better(t,s,a)}))});for(let s=0;s<2;++s)o.push(e.get_street_draw(t,s));let n=-1;return t!==void 0&&(n=e.get_player_index(t)),{player_index:n,street_results:r,draw_results:o}}let P=null;const $=async e=>(P=await import("./poker_eval-tV3S_Oez.js"),await P.default(),O(X(P))),J=async()=>{};R({initHandler:$,beforeTerminate:J});
