/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const R=Symbol("Comlink.proxy"),O=Symbol("Comlink.endpoint"),H=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.finalizer"),m=Symbol("Comlink.thrown"),S=e=>typeof e=="object"&&e!==null||typeof e=="function",N={canHandle:e=>S(e)&&e[R],serialize(e){const{port1:t,port2:r}=new MessageChannel;return k(e,t),[r,[r]]},deserialize(e){return e.start(),W(e)}},I={canHandle:e=>S(e)&&m in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},C=new Map([["proxy",N],["throw",I]]);function V(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function k(e,t=globalThis,r=["*"]){t.addEventListener("message",function a(s){if(!s||!s.data)return;if(!V(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:u,type:n,path:o}=Object.assign({path:[]},s.data),f=(s.data.argumentList||[]).map(g);let i;try{const l=o.slice(0,-1).reduce((c,d)=>c[d],e),y=o.reduce((c,d)=>c[d],e);switch(n){case"GET":i=y;break;case"SET":l[o.slice(-1)[0]]=g(s.data.value),i=!0;break;case"APPLY":i=y.apply(l,f);break;case"CONSTRUCT":{const c=new y(...f);i=L(c)}break;case"ENDPOINT":{const{port1:c,port2:d}=new MessageChannel;k(e,d),i=q(c,[c])}break;case"RELEASE":i=void 0;break;default:return}}catch(l){i={value:l,[m]:0}}Promise.resolve(i).catch(l=>({value:l,[m]:0})).then(l=>{const[y,c]=b(l);t.postMessage(Object.assign(Object.assign({},y),{id:u}),c),n==="RELEASE"&&(t.removeEventListener("message",a),T(t),E in e&&typeof e[E]=="function"&&e[E]())}).catch(l=>{const[y,c]=b({value:new TypeError("Unserializable return value"),[m]:0});t.postMessage(Object.assign(Object.assign({},y),{id:u}),c)})}),t.start&&t.start()}function F(e){return e.constructor.name==="MessagePort"}function T(e){F(e)&&e.close()}function W(e,t){return x(e,[],t)}function _(e){if(e)throw new Error("Proxy has been released and is not useable")}function A(e){return p(e,{type:"RELEASE"}).then(()=>{T(e)})}const h=new WeakMap,w="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(h.get(e)||0)-1;h.set(e,t),t===0&&A(e)});function j(e,t){const r=(h.get(t)||0)+1;h.set(t,r),w&&w.register(e,t,e)}function D(e){w&&w.unregister(e)}function x(e,t=[],r=function(){}){let a=!1;const s=new Proxy(r,{get(u,n){if(_(a),n===H)return()=>{D(s),A(e),a=!0};if(n==="then"){if(t.length===0)return{then:()=>s};const o=p(e,{type:"GET",path:t.map(f=>f.toString())}).then(g);return o.then.bind(o)}return x(e,[...t,n])},set(u,n,o){_(a);const[f,i]=b(o);return p(e,{type:"SET",path:[...t,n].map(l=>l.toString()),value:f},i).then(g)},apply(u,n,o){_(a);const f=t[t.length-1];if(f===O)return p(e,{type:"ENDPOINT"}).then(g);if(f==="bind")return x(e,t.slice(0,-1));const[i,l]=z(o);return p(e,{type:"APPLY",path:t.map(y=>y.toString()),argumentList:i},l).then(g)},construct(u,n){_(a);const[o,f]=z(n);return p(e,{type:"CONSTRUCT",path:t.map(i=>i.toString()),argumentList:o},f).then(g)}});return j(s,e),s}function U(e){return Array.prototype.concat.apply([],e)}function z(e){const t=e.map(b);return[t.map(r=>r[0]),U(t.map(r=>r[1]))]}const M=new WeakMap;function q(e,t){return M.set(e,t),e}function L(e){return Object.assign(e,{[R]:!0})}function b(e){for(const[t,r]of C)if(r.canHandle(e)){const[a,s]=r.serialize(e);return[{type:"HANDLER",name:t,value:a},s]}return[{type:"RAW",value:e},M.get(e)||[]]}function g(e){switch(e.type){case"HANDLER":return C.get(e.name).deserialize(e.value);case"RAW":return e.value}}function p(e,t,r){return new Promise(a=>{const s=G();e.addEventListener("message",function u(n){!n.data||!n.data.id||n.data.id!==s||(e.removeEventListener("message",u),a(n.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:s},t),r)})}function G(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let Y=[0,1,2,3,4,5,6,7,8];const $=e=>({flop_analyzer:e.flop_analyzer.new(),player_flop_results:[],reset(){this.flop_analyzer.reset()},setBoardCards(t){this.flop_analyzer.set_board_cards(t)},setPlayerCards(t,r){this.flop_analyzer.set_player_cards(t,r)},setPlayerRange(t,r){this.flop_analyzer.set_player_range(t,r)},setPlayerState(t,r){this.flop_analyzer.set_player_state(t,r)},clearPlayerCards(t){this.flop_analyzer.clear_player_cards(t)},initResults(){this.player_flop_results=this.flop_analyzer.build_results(),console.log(`initResults ${this.player_flop_results.length}`)},simulateFlop(t){this.player_flop_results=this.flop_analyzer.simulate_flop(t,this.player_flop_results)},getResults(){return console.log("getResults"),this.player_flop_results.map(a=>{const s=[],u=[];for(let n=0;n<3;n++)s.push({equity:a.get_equity(n),rank_family_count:Y.map(o=>({perc:a.get_perc_family(n,o),better:a.get_perc_family_or_better(n,o)}))});for(let n=0;n<2;++n)u.push(a.get_street_draw(n));return{player_index:a.player_index,street_results:s,draw_results:u}})}});let P=null;const B=async e=>(P=await import("./poker_eval-ZPvlpo0_.js"),await P.default(),L($(P))),X=async()=>{};k({initHandler:B,beforeTerminate:X});
