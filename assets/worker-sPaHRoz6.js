/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C=Symbol("Comlink.proxy"),N=Symbol("Comlink.endpoint"),q=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.finalizer"),p=Symbol("Comlink.thrown"),T=e=>typeof e=="object"&&e!==null||typeof e=="function",I={canHandle:e=>T(e)&&e[C],serialize(e){const{port1:t,port2:r}=new MessageChannel;return R(e,t),[r,[r]]},deserialize(e){return e.start(),W(e)}},V={canHandle:e=>T(e)&&p in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},A=new Map([["proxy",I],["throw",V]]);function j(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function R(e,t=globalThis,r=["*"]){t.addEventListener("message",function o(n){if(!n||!n.data)return;if(!j(r,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:s,type:i,path:u}=Object.assign({path:[]},n.data),c=(n.data.argumentList||[]).map(y);let l;try{const a=u.slice(0,-1).reduce((f,m)=>f[m],e),g=u.reduce((f,m)=>f[m],e);switch(i){case"GET":l=g;break;case"SET":a[u.slice(-1)[0]]=y(n.data.value),l=!0;break;case"APPLY":l=g.apply(a,c);break;case"CONSTRUCT":{const f=new g(...c);l=H(f)}break;case"ENDPOINT":{const{port1:f,port2:m}=new MessageChannel;R(e,m),l=B(f,[f])}break;case"RELEASE":l=void 0;break;default:return}}catch(a){l={value:a,[p]:0}}Promise.resolve(l).catch(a=>({value:a,[p]:0})).then(a=>{const[g,f]=w(a);t.postMessage(Object.assign(Object.assign({},g),{id:s}),f),i==="RELEASE"&&(t.removeEventListener("message",o),M(t),E in e&&typeof e[E]=="function"&&e[E]())}).catch(a=>{const[g,f]=w({value:new TypeError("Unserializable return value"),[p]:0});t.postMessage(Object.assign(Object.assign({},g),{id:s}),f)})}),t.start&&t.start()}function F(e){return e.constructor.name==="MessagePort"}function M(e){F(e)&&e.close()}function W(e,t){return P(e,[],t)}function d(e){if(e)throw new Error("Proxy has been released and is not useable")}function L(e){return _(e,{type:"RELEASE"}).then(()=>{M(e)})}const h=new WeakMap,b="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(h.get(e)||0)-1;h.set(e,t),t===0&&L(e)});function D(e,t){const r=(h.get(t)||0)+1;h.set(t,r),b&&b.register(e,t,e)}function U(e){b&&b.unregister(e)}function P(e,t=[],r=function(){}){let o=!1;const n=new Proxy(r,{get(s,i){if(d(o),i===q)return()=>{U(n),L(e),o=!0};if(i==="then"){if(t.length===0)return{then:()=>n};const u=_(e,{type:"GET",path:t.map(c=>c.toString())}).then(y);return u.then.bind(u)}return P(e,[...t,i])},set(s,i,u){d(o);const[c,l]=w(u);return _(e,{type:"SET",path:[...t,i].map(a=>a.toString()),value:c},l).then(y)},apply(s,i,u){d(o);const c=t[t.length-1];if(c===N)return _(e,{type:"ENDPOINT"}).then(y);if(c==="bind")return P(e,t.slice(0,-1));const[l,a]=k(u);return _(e,{type:"APPLY",path:t.map(g=>g.toString()),argumentList:l},a).then(y)},construct(s,i){d(o);const[u,c]=k(i);return _(e,{type:"CONSTRUCT",path:t.map(l=>l.toString()),argumentList:u},c).then(y)}});return D(n,e),n}function G(e){return Array.prototype.concat.apply([],e)}function k(e){const t=e.map(w);return[t.map(r=>r[0]),G(t.map(r=>r[1]))]}const O=new WeakMap;function B(e,t){return O.set(e,t),e}function H(e){return Object.assign(e,{[C]:!0})}function w(e){for(const[t,r]of A)if(r.canHandle(e)){const[o,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:o},n]}return[{type:"RAW",value:e},O.get(e)||[]]}function y(e){switch(e.type){case"HANDLER":return A.get(e.name).deserialize(e.value);case"RAW":return e.value}}function _(e,t,r){return new Promise(o=>{const n=Y();e.addEventListener("message",function s(i){!i.data||!i.data.id||i.data.id!==n||(e.removeEventListener("message",s),o(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:n},t),r)})}function Y(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let x=[0,1,2,3,4,5,6,7,8];const X=e=>({flop_analyzer:e.flop_analyzer.new(),results:null,reset(){this.flop_analyzer.reset()},setBoardCards(t){this.flop_analyzer.set_board_cards(t)},setPlayerCards(t,r){this.flop_analyzer.set_player_cards(t,r)},setPlayerRange(t,r){this.flop_analyzer.set_player_range(t,r)},setPlayerState(t,r){this.flop_analyzer.set_player_state(t,r)},clearPlayerCards(t){this.flop_analyzer.clear_player_cards(t)},initResults(){return this.results=this.flop_analyzer.build_results(),console.log("initResults"),this.results?!0:(console.error("results not initialized"),!1)},simulateFlop(t,r){return this.results?(this.results=this.flop_analyzer.simulate_flop(t,this.results,r),!0):(console.error("results not initialized"),!1)},getResults(){console.log("getResults");const t=this.results;if(!t)return console.error("results falsy"),[];const r=t.get_num_players(),o=[];for(let n=0;n<r;++n){let s=S(t,n);o.push(s)}return o.push(S(t,void 0)),o},narrowRange(t,r,o,n,s){const i=r.join(";");return this.flop_analyzer.narrow_range(t,i,o,n,s)},narrowRangeByPref(t,r,o,n){return this.flop_analyzer.narrow_range_by_pref(t,r,o,n)}});function S(e,t){const r=[],o=[];for(let s=0;s<3;s++){const i={equity:e.get_equity(t,s),win_rank_family_count:x.map(a=>({perc:e.get_perc_family(t,s,a,!0),better:e.get_perc_family_or_better(t,s,a,!0)})),lose_rank_family_count:x.map(a=>({perc:e.get_perc_family(t,s,a,!1),better:e.get_perc_family_or_better(t,s,a,!1)})),eq_by_simple_range_idx:[],it_num_by_simple_range_idx:[]},u=e.get_range_equity(t,s),c=e.get_range_it_count(t,s),l=[];for(let a=0;a<u.length;++a)c[a]>0?l.push(u[a]/c[a]):l.push(null);i.eq_by_simple_range_idx=l,i.it_num_by_simple_range_idx=c,r.push(i)}for(let s=0;s<2;++s)o.push(e.get_street_draw(t,s));let n=-1;return t!==void 0&&(n=e.get_player_index(t)),{player_index:n,street_results:r,draw_results:o}}let z=null;const $=async e=>(z=await import("./poker_eval-UiGF2tav.js"),await z.default(),H(X(z))),J=async()=>{};R({initHandler:$,beforeTerminate:J});
